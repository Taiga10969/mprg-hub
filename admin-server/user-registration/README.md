# 新規ユーザー登録フォーム（MPRG サーバー係用）

このHTMLファイルは，MPRGのサーバー利用者向けに，新規ユーザーの登録希望を受け付けるためのGoogle Apps Script（GAS）と連携するWebフォームです．
<img width="1313" alt="スクリーンショット 2025-03-26 午前9 25 14" src="https://github.com/user-attachments/assets/50e5a8d7-6491-4d5c-9b67-3d6c14d42503" />


## 📋 概要

このフォームでは以下の情報を収集し，GASを介してスプレッドシートなどに保存することを想定しています：

- 区分（学年や所属など）
- 希望アカウント名（重複不可）
- 氏名
- Slack ID

登録時に入力の妥当性チェックが行われ，アカウント名の重複やフォーマットエラーを検出します．


## ✨ 主な機能

- **リアルタイムバリデーション**  
  アカウント名の形式や重複チェックをリアルタイムで行い，送信ボタンの有効／無効を切り替えます．

- **ユーザー入力項目**  
  - 区分（選択式：B4, M1, M2, D1, D2, D3, other）
  - 希望アカウント名（英数字のみ，既存アカウントと重複不可）
  - 氏名
  - Slack ID（`@`で始まる）

- **Google Apps Script連携**
  - `getExistingAccounts()`：既存アカウント一覧を取得して重複チェックに使用．
  - `registerUser(data)`：フォーム送信データをGASで処理．


## 🚀 使用方法

1. Google Apps Script にこの HTMLファイル，GSファイルをアップロードし，Web アプリとしてデプロイします．
2. 以下の2つの関数を GAS 側に実装してあります：
   - `getExistingAccounts()`
   - `registerUser(data)`
3. `code.gs`の **SHEET_ID** には，対応するスプレットシートのIDをしてしてください．
   - スプレットシートは `sample.xlsx` を参考に作成してください．
5. ユーザーにURLを配布して，必要情報を入力してもらいます．
6. フォーム送信後，「登録が完了しました！」というメッセージが表示されます．


## ⚠️ 注意事項

- アカウント名は **英数字のみ**，**一意である必要があります**．
- Slack ID は `@` を含む形式で入力してください．
- GAS 側の関数が正しく動作しないと，データの送信や重複チェックが行えません．


